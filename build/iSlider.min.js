!function(t){"use strict";function i(t,i){return i.indexOf(t)>-1}var e=function(t){if(!t.dom)throw new Error("dom element can not be empty!");if(!t.data||!t.data.length)throw new Error("data must be an array and must have more than one element!");this._opts=t,this._setting(),this._renderHTML(),this._initPlugins(),this._bindHandler()};e.EVENTS="slide slideStart slideEnd slideChange slideChanged slideRestore slideRestored".split(" "),e.EASING=["linear ease ease-in ease-out ease-in-out".split(" "),/cubic-bezier\(([^\d]*(\d+.?\d*)[^\,]*\,?){4}\)/],e.EMPTY_FUNCTION=function(){},e.extend=function(){if(arguments.length){var t,i;switch(arguments.length){case 1:t=e.prototype,i=arguments[0];break;case 2:t=arguments[0],i=arguments[1]}for(var s in i)i.hasOwnProperty(s)&&(t[s]=i[s])}},e.plugins={},e.regPlugin=function(t,i){e.plugins[t]=e.plugins[t]||i},e._animateFuncs={"default":function(t,i,e,s,n){t.style.webkitTransform="translateZ(0) translate"+i+"("+(n+e*(s-1))+"px)"}},e._transitionEndEvent=function(){var t;return function(){if(t)return t;var i=document.createElement("fakeElement"),e={transition:"transitionend",OTransition:"oTransitionEnd",MozTransition:"transitionend",WebkitTransition:"webkitTransitionEnd"};for(var s in e)if(e.hasOwnProperty(s)&&void 0!==i.style[s])return t=e[s]}}();var s=e.prototype;s.extend=e.extend,s._setting=function(){this._plugins=e.plugins,this._animateFuncs=e._animateFuncs;var t=this._opts;this.wrap=t.dom,this.data=t.data,this.type=t.type||null,this.isVertical=t.isVertical||!1,this.isOverspread=t.isOverspread||!1,this.duration=t.duration||2e3,this.initIndex=t.initIndex||0,this.fixPage=void 0===t.fixPage?!0:t.fixPage,(this.initIndex>this.data.length-1||this.initIndex<0)&&(this.initIndex=0),this.slideIndex=this.slideIndex||this.initIndex||0,this.axis=this.isVertical?"Y":"X",this.reverseAxis="Y"===this.axis?"X":"Y",this.width=this.wrap.clientWidth,this.height=this.wrap.clientHeight,this.ratio=this.height/this.width,this.scale=this.isVertical?this.height:this.width,this.isLoading=t.isLoading,this.offset=this.offset||{X:0,Y:0},this.useZoom=t.useZoom||!1,this.data.length<2?(this.isLooping=!1,this.isAutoPlay=!1):(this.isLooping=t.isLooping||!1,this.isAutoplay=t.isAutoplay||!1),"card"===t.animateType&&this.isVertical&&(this.isOverspread=!0),this.useZoom&&this._initZoom(t),this.log=t.isDebug?function(){window.console.log.apply(console,arguments)}:e.EMPTY_FUNCTION,this._setUpDamping(),this._animateFunc=t.animateType in this._animateFuncs?this._animateFuncs[t.animateType]:this._animateFuncs["default"],this.animateTime=t.animateTime||300,this.animateEasing=i(t.animateEasing,e.EASING[0])||e.EASING[1].test(t.animateEasing)?t.animateEasing:"ease",this.inAnimate=0,this.events={},this.on("slide",t.onslide),this.on("slideStart",t.onslidestart),this.on("slideEnd",t.onslideend),this.on("slideChange",t.onslidechange),this.on("slideChanged",t.onslidechanged),this.on("slideRestore",t.onsliderestore),this.on("slideRestored",t.onsliderestored),this.isAutoplay&&this.play()},s.regPlugin=function(t,e){this._plugins[t]=this._plugins[t]||e,!i(t,this._opts.plugins)&&this._opts.plugins.push(t),"function"==typeof this._plugins[t]&&this._plugins[t]()},s._initPlugins=function(){this._opts.plugins&&this._opts.plugins.length>0&&this._opts.plugins.forEach(function(t){this._plugins.hasOwnProperty(t)&&(this.log("Init plugin:",t,this._plugins[t]),this._plugins[t]&&"function"==typeof this._plugins[t]&&typeof this._plugins[t].call&&this._plugins[t].call(this))}.bind(this))},s._setUpDamping=function(){var t=this.scale>>1,i=t>>1,e=i>>2;this._damping=function(s){var n,a=Math.abs(s);return n=t>a?a>>1:t+i>a?i+(a-t>>2):i+e+(a-t-i>>3),s>0?n:-n}},s._itemType=function(t){return null==t?"empty":Boolean(t.nodeName)&&Boolean(t.nodeType)?"element":"string"==typeof t?/[^\?#]+\.(jpg|jpeg|jpe|png|bmp|gif|tiff|tga)\??[^#]*#?.*$/.test(t)?"pic":"html":"unknown"},s._renderItem=function(t,i){var e,s,n=this.data.length,a=function(){s=e.height/e.width>this.ratio?'<img height="'+this.height+'" src="'+e.content+'">':'<img width="'+this.width+'" src="'+e.content+'">',t.innerHTML=s}.bind(this);if(this.isLooping||null!=this.data[i]){i=(n+i)%n,e=this.data[i],t.innerHTML="",t.style.background="";var h=null!=this.type?this.type:e.type||(e.type=this._itemType(e.content));switch(this.log("[Render ITEM]:",h,i,e),t.className="islider-"+h,h){case"pic":if(this.isOverspread)t.style.background="url("+e.content+") no-repeat 50% 50%/cover";else if(e.height&&e.width)a();else{var o=new Image;o.src=e.content,o.onload=function(){e.height=o.height,e.width=o.width,a()}}break;case"dom":case"html":t.innerHTML=e.content;break;case"element":t.appendChild(e.content)}}},s._renderHTML=function(){this.outer&&(this.outer.innerHTML="");var t=this.outer||document.createElement("ul");if(t.className="islider-outer",t.style.cssText="height:"+this.height+"px;width:"+this.width+"px;margin:0;padding:0;list-style:none;","pic"===this.type&&!this.loader&&this.isLoading){var i=document.createElement("div");i.className="islider-loader",this.loader=i,this.wrap.appendChild(i)}this.els=[];for(var e=0;3>e;e++){var s=document.createElement("li");s.style.cssText="height:"+this.height+"px;width:"+this.width+"px;",this.els.push(s),this._animateFunc(s,this.axis,this.scale,e,0),!this.isVertical||"rotate"!==this._opts.animateType&&"flip"!==this._opts.animateType?this._renderItem(s,e-1+this.slideIndex):this._renderItem(s,1-e+this.slideIndex),t.appendChild(s)}this._initLoadImg(),this.outer||(this.outer=t,this.wrap.appendChild(t))},s._preloadImg=function(t){if("pic"===this._itemType(this.data[t])){var i=this.data.length,e=t,s=function(t){if(t>-1&&!this.data[t].loaded){var i=new Image;i.src=this.data[t].content,i.onload=function(){this.data[t].width=i.width,this.data[t].height=i.height},this.data[t].loaded=1}}.bind(this);if("dom"!==this.type&&i>3){var n=e+2>i-1?(e+2)%i:e+2,a=0>e-2?i-2+e:e-2;s(n),s(a)}}},s._initLoadImg=function(){var t=this.data,i=t.length,e=this.slideIndex,s=this;if("dom"!==this.type&&i>3){var n=e+2>i?(e+1)%i:e+1,a=0>e-1?i-1+e:e-1;t[e].loaded=1,t[n].loaded=1,s.isLooping&&(t[a].loaded=1),setTimeout(function(){s._preloadImg(e)},200)}},s.slideTo=function(t){var i=this.data,e=this.els,s=t,n=t-this.slideIndex,a=this.offset,h=Math.abs(a[this.axis])/this.scale*this.animateTime;Math.abs(n)>1&&this._renderItem(n>0?this.els[2]:this.els[0],s),this._preloadImg(s),i[s]?this.slideIndex=s:this.isLooping?this.slideIndex=n>0?0:i.length-1:(this.slideIndex=this.slideIndex,n=0),this.log("Index:"+this.slideIndex);var o;!this.isVertical||"rotate"!==this._opts.animateType&&"flip"!==this._opts.animateType?n>0?(o=e.shift(),e.push(o)):0>n&&(o=e.pop(),e.unshift(o)):n>0?(o=e.pop(),e.unshift(o)):0>n&&(o=e.shift(),e.push(o)),0!==n?(Math.abs(n)>1?(this._renderItem(e[0],s-1),this._renderItem(e[2],s+1)):1===Math.abs(n)&&this._renderItem(o,s+n),o.style.webkitTransition="none",o.style.visibility="hidden",setTimeout(function(){o.style.visibility="visible"},200),h=this.animateTime-h,this.fire("slideChange",this.slideIndex,e[1],this),this._watchTransitionEnd(h,"slideChanged",this.slideIndex,e[1],this)):(this.fire("slideRestore",this.slideIndex,e[1],this),this._watchTransitionEnd(h,"slideRestored",this.slideIndex,e[1],this));for(var r=0;3>r;r++)e[r]!==o&&(e[r].style.webkitTransition="all "+h/1e3+"s "+this.animateEasing),this._animateFunc(e[r],this.axis,this.scale,r,0);this.isAutoplay&&!this.isLooping&&this.slideIndex===i.length-1&&this.pause()},s._watchTransitionEnd=function(t){function i(){n.inAnimate--,n.log("Event:","watchTransitionEnd::stuck::release",n.inAnimate),0===n.inAnimate&&(n.inAnimate=0,n.fire.apply(n,a)),s()}function s(){n.els.forEach(function(t){t.removeEventListener(e._transitionEndEvent(),i)}),n.isAnimating=!1}var n=this,a=Array.prototype.slice.call(arguments,1);n.log("Event:","watchTransitionEnd::stuck::pile",n.inAnimate),t>0&&(n.els.forEach(function(t){t.addEventListener(e._transitionEndEvent(),i)}),n.inAnimate++)},s._device=function(){var t=!!("ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch),i=t?"touchstart":"mousedown",e=t?"touchmove":"mousemove",s=t?"touchend":"mouseup";return{hasTouch:t,startEvt:i,moveEvt:e,endEvt:s}},s._bindHandler=function(){var t=this.outer,i=this._device();i.hasTouch||(t.style.cursor="pointer",t.ondragstart=function(t){return t?!1:!0}),t.addEventListener(i.startEvt,this),t.addEventListener(i.moveEvt,this),t.addEventListener(i.endEvt,this),window.addEventListener("orientationchange",this),window.addEventListener("focus",this,!1),window.addEventListener("blur",this,!1)},s.bind=s.delegate=function(t,i,e){function s(t){for(var s=window.event?window.event:t,n=s.target,a=document.querySelectorAll(i),h=0;h<a.length;h++)if(n===a[h]){e.call(n);break}}this.wrap.addEventListener(t,s,!1)},s.destroy=function(){var t=this.outer,i=this._device();t.removeEventListener(i.startEvt,this),t.removeEventListener(i.moveEvt,this),t.removeEventListener(i.endEvt,this),window.removeEventListener("orientationchange",this),window.removeEventListener("focus",this),window.removeEventListener("blur",this),this.wrap.innerHTML=""},s.on=function(t,s){i(t,e.EVENTS)&&"function"==typeof s&&(t in this.events?this.events[t]:this.events[t]=[]).push(s)},s.off=function(t,i){if(t in this.events){var e=this.events[t],s=e.indexOf(i);s>-1&&delete e[s]}},s.fire=function(t){if(this.log("[EVENT FIRE]:",t,arguments),t in this.events)for(var i=this.events[t],e=0;e<i.length;e++)"function"==typeof i[e]&&i[e].apply&&i[e].apply(this,Array.prototype.slice.call(arguments,1))},s.handleEvent=function(t){var i=this._device();switch(t.type){case i.startEvt:this.startHandler(t);break;case i.moveEvt:this.moveHandler(t);break;case i.endEvt:this.endHandler(t);break;case"touchcancel":this.endHandler(t);break;case"orientationchange":this.orientationchangeHandler();break;case"focus":this.isAutoplay&&this.play();break;case"blur":this.pause()}},s.startHandler=function(t){if(this.fixPage){var i=t.target;"SELECT"!==i.tagName&&"INPUT"!==i.tagName&&"TEXTAREA"!==i.tagName&&t.preventDefault()}var e=this._device();this.isMoving=!0,this.pause(),this.log("Event: start"),this.fire("slideStart",t,this),this.startTime=(new Date).getTime(),this.startX=e.hasTouch?t.targetTouches[0].pageX:t.pageX,this.startY=e.hasTouch?t.targetTouches[0].pageY:t.pageY,this._startHandler&&this._startHandler(t)},s.moveHandler=function(t){if(this.isMoving){this.log("Event: moving");var i=this._device(),e=this.data.length,s=this.axis,n=this.reverseAxis,a={X:i.hasTouch?t.targetTouches[0].pageX-this.startX:t.pageX-this.startX,Y:i.hasTouch?t.targetTouches[0].pageY-this.startY:t.pageY-this.startY},h=this._moveHandler?this._moveHandler(t):!1;if(!h&&Math.abs(a[s])-Math.abs(a[n])>10){t.preventDefault(),this.fire("slide",a[s],this),this.isLooping||(a[s]>0&&0===this.slideIndex||a[s]<0&&this.slideIndex===e-1)&&(a[s]=this._damping(a[s]));for(var o=0;3>o;o++){var r=this.els[o];r.style.webkitTransition="all 0s",this._animateFunc(r,s,this.scale,o,a[s])}}this.offset=a}},s.endHandler=function(t){this.log("Event: end"),this.isMoving=!1;var i=this.offset,e=this.axis,s=this.scale/2,n=(new Date).getTime();s=n-this.startTime>300?s:14;var a=this._endHandler?this._endHandler(t):!1,h=Math.abs(i[e]),o=Math.abs(i[this.reverseAxis]),r=function(t){if("A"===t.tagName){if(t.href)return window.location.href=t.href,!1}else{if("islider-dom"===t.className)return!1;r(t.parentNode)}};this.log(s,i[e],h,o,this),!a&&i[e]>=s&&h>o?this.slideTo(this.slideIndex-1):!a&&i[e]<-s&&h>o?this.slideTo(this.slideIndex+1):a||this.slideTo(this.slideIndex),Math.abs(this.offset.X)<10&&Math.abs(this.offset.Y)<10&&(this.tapEvt=document.createEvent("Event"),this.tapEvt.initEvent("tap",!0,!0),this.fixPage&&"dom"===this.type&&r(t.target),t.target.dispatchEvent(this.tapEvt)||t.preventDefault()),this.offset.X=this.offset.Y=0,this.isAutoplay&&this.play(),this.fire("slideEnd",this.slideIndex,this)},s.orientationchangeHandler=function(){setTimeout(function(){this.reset(),this.log("Event: orientationchange")}.bind(this),100)},s.reset=function(){this.pause(),this._setting(),this._renderHTML(),this.isAutoplay&&this.play()},s.loadData=function(t,i){this.pause(),this.slideIndex=i||0,this.data=t,this._renderHTML(),this.isAutoplay&&this.play()},s.play=function(){var t=this,i=this.duration;clearInterval(this.autoPlayTimer),this.autoPlayTimer=setInterval(function(){t.slideTo(t.slideIndex+1)},i)},s.pause=function(){clearInterval(this.autoPlayTimer)},"function"==typeof require&&"object"==typeof module&&module&&"object"==typeof exports&&exports?module.exports=e:"function"==typeof define&&define.amd?define(function(){return e}):t.iSlider=t.iSlider||e}(this);