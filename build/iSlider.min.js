!function(t){"use strict";function i(t,i){return i.indexOf(t)>-1}function e(t){return"[object Array]"===Object.prototype.toString.call(t)}function s(t,i){return t.className.match(new RegExp("(\\s|^)"+i+"(\\s|$)"))}function n(t,i){s(t,i)||(t.className+=" "+i)}function a(t,i){s(t,i)&&(t.className=t.className.replace(RegExp("(\\s|^)"+i+"(\\s|$)"),""))}function h(t){if(/<\/?[^>]*>/g.test(t))return!1;var i="^(((https|http|ftp|rtsp|mms):)?//)?(([0-9a-z_!~*'().&=+$%-]+: )?[0-9a-z_!~*'().&=+$%-]+@)?(([0-9]{1,3}.){3}[0-9]{1,3}|([0-9a-z_!~*'()-]+.)*([0-9a-z][0-9a-z-]{0,61})?[0-9a-z].[a-z]{2,6})?(:[0-9]{1,4})?([^?#]+)?(\\?[^#]+)?(#.+)?$";return new RegExp(i).test(t)}var r=function(t){if(!t.dom)throw new Error("Container can not be empty!");if(!t.data||!t.data.length)throw new Error("Data must be an array and must have more than one element!");this._opts=t,this._setting(),this._renderHTML(),this._initPlugins(),this._bindHandler()};r.EVENTS="slide slideStart slideEnd slideChange slideChanged slideRestore slideRestored destroy".split(" "),r.EASING=["linear ease ease-in ease-out ease-in-out".split(" "),/cubic-bezier\(([^\d]*(\d+.?\d*)[^\,]*\,?){4}\)/],r.EMPTY_FUNCTION=function(){},r.extend=function(){if(arguments.length){var t,i;switch(arguments.length){case 1:t=r.prototype,i=arguments[0];break;case 2:t=arguments[0],i=arguments[1]}for(var e in i)i.hasOwnProperty(e)&&(t[e]=i[e])}},r.plugins={},r.regPlugin=function(t,i){r.plugins[t]=r.plugins[t]||i},r._animateFuncs={"default":function(t,i,e,s,n){t.style.webkitTransform="translateZ(0) translate"+i+"("+(n+e*(s-1))+"px)"}},r._transitionEndEvent=function(){var t;return function(){if(t)return t;var i=document.createElement("fakeElement"),e={transition:"transitionend",OTransition:"oTransitionEnd",MozTransition:"transitionend",WebkitTransition:"webkitTransitionEnd"};for(var s in e)if(e.hasOwnProperty(s)&&void 0!==i.style[s])return t=e[s]}}();var o=r.prototype;o.extend=r.extend,o._setting=function(){this._plugins=r.plugins,this._animateFuncs=r._animateFuncs,this.holding=!1,this.locking=!1;var s=this._opts;this.wrap=s.dom,this.data=s.data,this.type=s.type||null,this.isVertical=s.isVertical||!1,this.isOverspread=s.isOverspread||!1,this.duration=s.duration||2e3,this.initIndex=s.initIndex||0,this.fixPage=void 0===s.fixPage?!0:s.fixPage,(this.initIndex>this.data.length-1||this.initIndex<0)&&(this.initIndex=0),this.slideIndex=this.slideIndex||this.initIndex||0,this.axis=this.isVertical?"Y":"X",this.reverseAxis="Y"===this.axis?"X":"Y",this.width=this.wrap.clientWidth,this.height=this.wrap.clientHeight,this.ratio=this.height/this.width,this.scale=this.isVertical?this.height:this.width,this.isLoading=s.isLoading,this.offset=this.offset||{X:0,Y:0},this.data.length<2?(this.isLooping=!1,this.isAutoPlay=!1):(this.isLooping=s.isLooping||!1,this.isAutoplay=s.isAutoplay||!1),"card"===s.animateType&&this.isVertical&&(this.isOverspread=!0),this.log=s.isDebug?function(){t.console.log.apply(t.console,arguments)}:r.EMPTY_FUNCTION,this._setUpDamping(),this._animateFunc=this._animateFuncs[s.animateType in this._animateFuncs?s.animateType:"default"],this.animateTime=null!=s.animateTime&&s.animateTime>-1?s.animateTime:300,this.animateEasing=i(s.animateEasing,r.EASING[0])||r.EASING[1].test(s.animateEasing)?s.animateEasing:"ease",this.inAnimate=0,this.deviceEvents=function(){var i=!!("ontouchstart"in t||t.DocumentTouch&&document instanceof t.DocumentTouch);return{hasTouch:i,startEvt:i?"touchstart":"mousedown",moveEvt:i?"touchmove":"mousemove",endEvt:i?"touchend":"mouseup"}}(),this.events={},this.on("slide",s.onslide),this.on("slideStart",s.onslidestart),this.on("slideEnd",s.onslideend),this.on("slideChange",s.onslidechange),this.on("slideChanged",s.onslidechanged),this.on("slideRestore",s.onsliderestore),this.on("slideRestored",s.onsliderestored),this.pluginConfig=function(){if(e(s.plugins)){var t={};return s.plugins.forEach(function(i){e(i)?t[i[0]]=i.slice(1):"string"==typeof i&&(t[i]=[])}),t}return{}}(),this.isAutoplay&&this.play()},o._initPlugins=function(){var t=this.pluginConfig,i=this._plugins;for(var e in t)t.hasOwnProperty(e)&&i.hasOwnProperty(e)&&(this.log("[INIT PLUGIN]:",e,i[e]),i[e]&&"function"==typeof i[e]&&typeof i[e].apply&&i[e].apply(this,t[e]))},o._setUpDamping=function(){var t=this.scale>>1,i=t>>1,e=i>>2;this._damping=function(s){var n,a=Math.abs(s);return n=t>a?a>>1:t+i>a?i+(a-t>>2):i+e+(a-t-i>>3),s>0?n:-n}},o._itemType=function(t){var i=this.data[t].content;return null==i?"empty":Boolean(i.nodeName)&&Boolean(i.nodeType)?"node":"string"==typeof i?h(i)?"pic":"html":"unknown"},o._renderItem=function(t,i){var e,s,n=this.data.length,a=function(){s=e.height/e.width>this.ratio?'<img height="'+this.height+'" src="'+e.content+'">':'<img width="'+this.width+'" src="'+e.content+'">',t.innerHTML=s}.bind(this);if(t.innerHTML="",t.style.background="",this.isLooping||null!=this.data[i]){i=(n+i)%n,e=this.data[i];var h=null!=this.type?this.type:e.type||(e.type=this._itemType(i));switch(this.log("[Render ITEM]:",h,i,e),t.className="islider-"+h,h){case"pic":if(this.isOverspread)t.style.background="url("+e.content+") no-repeat 50% 50%/cover";else if(e.height&&e.width)a();else{var r=new Image;r.src=e.content,r.onload=function(){e.height=r.height,e.width=r.width,a()}}break;case"dom":case"html":t.innerHTML=e.content;break;case"node":case"element":if(11===e.content.nodeType){var o=document.createElement("div");o.appendChild(e.content),e.content=o}t.appendChild(e.content)}}},o._renderIntermediateScene=function(){null!=this._intermediateScene&&(this._renderItem.apply(this,this._intermediateScene),this._intermediateScene=null)},o._changedStyles=function(){var t=["islider-prev","islider-active","islider-next"];this.els.forEach(function(i,e){a(i,"("+t.join("|")+")"),n(i,t[e])})},o._renderHTML=function(){this.outer&&(this.outer.innerHTML="");var t=this.outer||document.createElement("ul");if(t.className="islider-outer",t.style.cssText="height:"+this.height+"px;width:"+this.width+"px;margin:0;padding:0;list-style:none;","pic"===this.type&&!this.loader&&this.isLoading){var i=document.createElement("div");i.className="islider-loader",this.loader=i,this.wrap.appendChild(i)}this.els=[];for(var e=0;3>e;e++){var s=document.createElement("li");s.style.cssText="height:"+this.height+"px;width:"+this.width+"px;",this.els.push(s),this._animateFunc(s,this.axis,this.scale,e,0),!this.isVertical||"rotate"!==this._opts.animateType&&"flip"!==this._opts.animateType?this._renderItem(s,e-1+this.slideIndex):this._renderItem(s,1-e+this.slideIndex),t.appendChild(s)}this._changedStyles(),this._initLoadImg(),this.outer||(this.outer=t,this.wrap.appendChild(t))},o._preloadImg=function(t){if("pic"===this.type&&this.data.length>3){var i=this.data,e=i.length,s=function(t){if(t>-1&&"pic"===i[t].type&&!i[t].loaded){var e=new Image;e.src=i[t].content,e.onload=function(){i[t].width=e.width,i[t].height=e.height},i[t].loaded=1}};s(t+2>e-1?(t+2)%e:t+2),s(0>t-2?e-2+t:t-2)}},o._initLoadImg=function(){var t=this.data,i=t.length,e=this.slideIndex,s=this;if("pic"===this.type&&i>3){var n=e+2>i?(e+1)%i:e+1,a=0>e-1?i-1+e:e-1;t[e].loaded=1,t[n].loaded=1,s.isLooping&&(t[a].loaded=1),setTimeout(function(){s._preloadImg(e)},200)}},o._watchTransitionEnd=function(i,e){function s(){a&&t.clearTimeout(a),h.inAnimate--,h.log("Event:","watchTransitionEnd::stuck::release",h.inAnimate),0===h.inAnimate&&("slideChanged"===e&&h._changedStyles(),h.fire.apply(h,o),h._renderIntermediateScene()),n()}function n(){h.els.forEach(function(t){t.removeEventListener(r._transitionEndEvent(),s)}),h.isAnimating=!1}var a,h=this,o=Array.prototype.slice.call(arguments,1);this.log("Event:","watchTransitionEnd::stuck::pile",this.inAnimate),i>0&&h.els.forEach(function(t){t.addEventListener(r._transitionEndEvent(),s)}),a=t.setTimeout(s,i),h.inAnimate++},o._bindHandler=function(){var i=this.outer,e=this.deviceEvents;e.hasTouch||(i.style.cursor="pointer",i.ondragstart=function(t){return t?!1:!0}),i.addEventListener(e.startEvt,this),i.addEventListener(e.moveEvt,this),i.addEventListener(e.endEvt,this),t.addEventListener("orientationchange",this),t.addEventListener("focus",this,!1),t.addEventListener("blur",this,!1)},o.handleEvent=function(t){var i=this.deviceEvents;switch(t.type){case i.startEvt:this.startHandler(t);break;case i.moveEvt:this.moveHandler(t);break;case i.endEvt:this.endHandler(t);break;case"touchcancel":this.endHandler(t);break;case"orientationchange":this.orientationchangeHandler();break;case"focus":this.isAutoplay&&this.play();break;case"blur":this.pause()}},o.startHandler=function(t){if(this.fixPage){var i=t.target,e=["SELECT","INPUT","TEXTAREA","BUTTON","LABEL"];e.indexOf(i.tagName)<0&&t.preventDefault()}if(!this.holding&&!this.locking){var s=this.deviceEvents;this.isMoving=!0,this.pause(),this.log("Event: start"),this.fire("slideStart",t,this),this.startTime=(new Date).getTime(),this.startX=s.hasTouch?t.targetTouches[0].pageX:t.pageX,this.startY=s.hasTouch?t.targetTouches[0].pageY:t.pageY}},o.moveHandler=function(t){if(this.isMoving){this.log("Event: moving");var i=this.deviceEvents,e=this.data.length,s=this.axis,n=this.reverseAxis,a={X:i.hasTouch?t.targetTouches[0].pageX-this.startX:t.pageX-this.startX,Y:i.hasTouch?t.targetTouches[0].pageY-this.startY:t.pageY-this.startY};if(this.offset=a,Math.abs(a[s])-Math.abs(a[n])>10){t.preventDefault(),this.fire("slide",t,this),this.isLooping||(a[s]>0&&0===this.slideIndex||a[s]<0&&this.slideIndex===e-1)&&(a[s]=this._damping(a[s]));for(var h=0;3>h;h++){var r=this.els[h];r.style.webkitTransition="all 0s",this._animateFunc(r,s,this.scale,h,a[s])}}}},o.endHandler=function(i){if(this.isMoving){this.log("Event: end"),this.isMoving=!1;var e=this.offset,s=this.axis,n=this.scale/2,a=(new Date).getTime();n=a-this.startTime>300?n:14;var h=Math.abs(e[s]),r=Math.abs(e[this.reverseAxis]),o=function(i){if("A"===i.tagName){if(i.href)return t.location.href=i.href,!1}else{if("islider-pic"!==i.className)return!1;o(i.parentNode)}};this.log(n,e[s],h,r,this),this.slideTo(e[s]>=n&&h>r?this.slideIndex-1:e[s]<-n&&h>r?this.slideIndex+1:this.slideIndex),Math.abs(this.offset.X)<10&&Math.abs(this.offset.Y)<10&&(this.tapEvt=document.createEvent("Event"),this.tapEvt.initEvent("tap",!0,!0),this.fixPage&&i.target&&o(i.target),i.target.dispatchEvent(this.tapEvt)||i.preventDefault()),this.offset.X=this.offset.Y=0,this.isAutoplay&&this.play(),this.fire("slideEnd",i,this)}},o.orientationchangeHandler=function(){setTimeout(function(){this.reset(),this.log("Event: orientationchange")}.bind(this),100)},o.slideTo=function(t,i){if(!this.locking){this.unhold();var e,s=this.animateTime,n=this._opts.animateType,a=this._animateFunc,h=this.data,r=this.els,o=t,l=t-this.slideIndex,d=this.offset;"object"==typeof i&&(i.animateTime>-1&&(s=i.animateTime),"string"==typeof i.animateType&&i.animateType in this._animateFuncs&&(n=i.animateType,a=this._animateFuncs[n]));var c=Math.abs(d[this.axis])/this.scale*s;Math.abs(l)>1&&this._renderItem(l>0?this.els[2]:this.els[0],o),this._preloadImg(o),h[o]?this.slideIndex=o:this.isLooping?this.slideIndex=l>0?0:h.length-1:(this.slideIndex=this.slideIndex,l=0),this.log("Index:"+this.slideIndex);var u,p;if(0===l)e="slideRestore";else{var f=(this.isVertical&&("rotate"===n||"flip"===n))^l>0;f?(r.push(r.shift()),u=r[2],p=r[0]):(r.unshift(r.pop()),u=r[0],p=r[2]),1===Math.abs(l)?(this._renderIntermediateScene(),this._renderItem(u,o+l)):Math.abs(l)>1&&(this._renderItem(u,o+(f?1:-1)),this._intermediateScene=[p,o+(f?-1:1)]),u.style.webkitTransition="none",u.style.visibility="hidden",setTimeout(function(){u.style.visibility="visible"},200),c=s-c,e="slideChange"}this.fire(e,this.slideIndex,r[1],this),this._watchTransitionEnd(c,e+"d",this.slideIndex,r[1],this);for(var g=0;3>g;g++)r[g]!==u&&(r[g].style.webkitTransition="all "+c/1e3+"s "+this.animateEasing),a.call(this,r[g],this.axis,this.scale,g,0);this.isAutoplay&&!this.isLooping&&this.slideIndex===h.length-1&&this.pause()}},o.slideNext=function(){this.slideTo.apply(this,[this.slideIndex+1].concat(Array.prototype.slice.call(arguments)))},o.slidePrev=function(){this.slideTo.apply(this,[this.slideIndex-1].concat(Array.prototype.slice.call(arguments)))},o.regPlugin=function(){var t=Array.prototype.slice.call(arguments),e=t.shift(),s=t[0];(this._plugins.hasOwnProperty(e)||"function"==typeof s)&&("function"==typeof s&&(this._plugins[e]=s,t.shift()),i(e,this._opts.plugins)||(this._opts.plugins.push(t.length?[].concat([e],t):e),"function"==typeof this._plugins[e]&&this._plugins[e].apply(this,t)))},o.bind=o.delegate=function(i,e,s){function n(i){for(var n=t.event?t.event:i,a=n.target,h=document.querySelectorAll(e),r=0;r<h.length;r++)if(a===h[r]){s.call(a);break}}this.wrap.addEventListener(i,n,!1)},o.destroy=function(){var i=this.outer,e=this.deviceEvents;this.fire("destroy"),i.removeEventListener(e.startEvt,this),i.removeEventListener(e.moveEvt,this),i.removeEventListener(e.endEvt,this),t.removeEventListener("orientationchange",this),t.removeEventListener("focus",this),t.removeEventListener("blur",this),this.wrap.innerHTML=""},o.on=function(t,e){i(t,r.EVENTS)&&"function"==typeof e&&(t in this.events?this.events[t]:this.events[t]=[]).push(e)},o.off=function(t,i){if(t in this.events){var e=this.events[t],s=e.indexOf(i);s>-1&&delete e[s]}},o.fire=function(t){if(this.log("[EVENT FIRE]:",t,arguments),t in this.events)for(var i=this.events[t],e=0;e<i.length;e++)"function"==typeof i[e]&&i[e].apply&&i[e].apply(this,Array.prototype.slice.call(arguments,1))},o.reset=function(){this.pause(),this._setting(),this._renderHTML(),this.isAutoplay&&this.play()},o.loadData=function(t,i){this.pause(),this.slideIndex=i||0,this.data=t,this._renderHTML(),this._initPlugins(),this.isAutoplay&&this.play()},o.play=function(){var t=this,i=this.duration;clearInterval(this.autoPlayTimer),this.autoPlayTimer=setInterval(function(){t.slideTo(t.slideIndex+1)},i)},o.pause=function(){clearInterval(this.autoPlayTimer)},o.hold=function(){this.holding=!0},o.unhold=function(){this.holding=!1,this.unlock()},o.lock=function(){this.hold(),this.locking=!0},o.unlock=function(){this.locking=!1},"function"==typeof require&&"object"==typeof module&&module&&"object"==typeof exports&&exports?module.exports=r:"function"==typeof define&&define.amd?define(function(){return r}):t.iSlider=t.iSlider||r}(this||window);